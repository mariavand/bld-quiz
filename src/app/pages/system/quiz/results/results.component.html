@if(userResult()){
  <p-splitter class="mb-8" layout="vertical">

    <ng-template pTemplate="pane">
      <div class="flex justify-content-center align-items-center h-full">
        <h2>{{ calculatedScore() }}%</h2>
      </div>
    </ng-template>

    <ng-template pTemplate="pane">
      <section class="m-3 h-full flex flex-column flex-grow align-items-center w-full">

        <p-card [header]="userResult()?.title" class="text-center w-full">
          <div class="flex my-3 justify-content-center align-items-center">
            <img [src]="'assets/images/' + userResult()?.img" class="h-full w-10rem" [alt]="userResult()?.img">
          </div>
          <div>
            {{ userResult()?.message }}
          </div>
        </p-card>

        <p-divider class="my-3 w-full" />

        <p-fieldset legend="Answers" class="w-full">
          <div class="mb-2 p-2">
            @let quiz = quizData()?.questions;
            @for(answer of userAnswers(); track $index;){
              <div>
                <div class="flex gap-2 justify-content-center align-items-center mb-4">
                  <h3>{{ quiz![$index].title }}</h3>
                  @if(answer?.correctnessStatus || answer[0]?.correctnessStatus){
                    <i class="pi pi-check-circle text-base"></i>
                  }
                  @else {
                    <i class="pi pi-times-circle text-base"></i>
                  }
                </div>

                <p-splitter>
                  <ng-template pTemplate="pane">
                    <div class="flex flex-column justify-content-center align-items-center h-full">
                      <h4>Your Answer</h4>
                      @switch(quiz![$index].question_type){
                        @case ('multiplechoice-single') {
                          <span>{{ answer.caption }}</span>
                        }
                        @case ('multiplechoice-multiple') {
                          @for(ans of answer; track ans){
                            <span>{{ ans.caption }}</span>
                          }
                        }
                        @default {
                          <span>{{ answer.correctnessStatus ? 'Yes' : 'No' }}</span>
                        }
                      }
                    </div>
                  </ng-template>
                  <ng-template pTemplate="pane">
                    <div class="flex flex-column justify-content-center align-items-center h-full">
                      <h4>Correct Answer</h4>

                      @let q = quiz![$index];

                      @switch(q.question_type){
                        @case ('multiplechoice-single') {
                          <span>{{ correctAnswer()[$index].caption }}</span>
                        }
                        @case ('multiplechoice-multiple') {
                          @for(ans of correctAnswer()[$index]; track ans){
                            <span>{{ ans.caption }}</span>
                          }
                        }
                        @default {
                          <span>{{ correctAnswer()[$index] ? 'Yes' : 'No' }}</span>
                        }
                      }
                    </div>
                  </ng-template>
                </p-splitter>
              </div>
              <p-divider class="my-4 w-full" />
            }
          </div>
        </p-fieldset>
      </section>
    </ng-template>
  </p-splitter>
}
@else {
  <div class="h-30rem w-30rem flex justify-content-center align-items-center">
    <span class="loader"></span>
  </div>
}
